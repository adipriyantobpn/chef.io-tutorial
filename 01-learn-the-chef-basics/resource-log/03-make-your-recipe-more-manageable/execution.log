vagrant@vagrant:~/chef-repo$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo$ # -- Create cookbook directory
vagrant@vagrant:~/chef-repo$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo$ mkdir ~/chef-repo/cookbooks
vagrant@vagrant:~/chef-repo$ cd ~/chef-repo/cookbooks
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ # -- Generate cookbook named `learn_chef_apache2`
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ chef generate cookbook learn_chef_apache2
Compiling Cookbooks...
Recipe: code_generator::cookbook
  * directory[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2] action create
    - create new directory /home/vagrant/chef-repo/cookbooks/learn_chef_apache2
  * template[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/metadata.rb] action create_if_missing
    - create new file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/metadata.rb
    - update content in file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/metadata.rb from none to 71d760
    (diff output suppressed by config)
  * template[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/README.md] action create_if_missing
    - create new file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/README.md
    - update content in file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/README.md from none to 49235c
    (diff output suppressed by config)
  * cookbook_file[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/chefignore] action create
    - create new file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/chefignore
    - update content in file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/chefignore from none to 51b09a
    (diff output suppressed by config)
  * cookbook_file[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/Berksfile] action create_if_missing
    - create new file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/Berksfile
    - update content in file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/Berksfile from none to 5ec92e
    (diff output suppressed by config)
  * template[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/.kitchen.yml] action create_if_missing
    - create new file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/.kitchen.yml
    - update content in file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/.kitchen.yml from none to f8d1ff
    (diff output suppressed by config)
  * directory[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/test/integration/default/serverspec] action create
    - create new directory /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/test/integration/default/serverspec
  * directory[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/test/integration/helpers/serverspec] action create
    - create new directory /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/test/integration/helpers/serverspec
  * cookbook_file[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/test/integration/helpers/serverspec/spec_helper.rb] action create_if_missing
    - create new file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/test/integration/helpers/serverspec/spec_helper.rb
    - update content in file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/test/integration/helpers/serverspec/spec_helper.rb from none to a226b8
    (diff output suppressed by config)
  * template[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/test/integration/default/serverspec/default_spec.rb] action create_if_missing
    - create new file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/test/integration/default/serverspec/default_spec.rb
    - update content in file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/test/integration/default/serverspec/default_spec.rb from none to 0dc627
    (diff output suppressed by config)
  * directory[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/spec/unit/recipes] action create
    - create new directory /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/spec/unit/recipes
  * cookbook_file[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/spec/spec_helper.rb] action create_if_missing
    - create new file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/spec/spec_helper.rb
    - update content in file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/spec/spec_helper.rb from none to 945e09
    (diff output suppressed by config)
  * template[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/spec/unit/recipes/default_spec.rb] action create_if_missing
    - create new file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/spec/unit/recipes/default_spec.rb
    - update content in file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/spec/unit/recipes/default_spec.rb from none to 1a66b0
    (diff output suppressed by config)
  * directory[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/recipes] action create
    - create new directory /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/recipes
  * template[/home/vagrant/chef-repo/cookbooks/learn_chef_apache2/recipes/default.rb] action create_if_missing
    - create new file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/recipes/default.rb
    - update content in file /home/vagrant/chef-repo/cookbooks/learn_chef_apache2/recipes/default.rb from none to 9fb7d1
    (diff output suppressed by config)
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ # -- Review cookbook directory structure
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ tree
.
└── learn_chef_apache2
    ├── Berksfile
    ├── chefignore
    ├── metadata.rb
    ├── README.md
    ├── recipes
    │   └── default.rb
    ├── spec
    │   ├── spec_helper.rb
    │   └── unit
    │       └── recipes
    │           └── default_spec.rb
    └── test
        └── integration
            ├── default
            │   └── serverspec
            │       └── default_spec.rb
            └── helpers
                └── serverspec
                    └── spec_helper.rb

11 directories, 9 files
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ # -- Generate HTML template for `learn_chef_apache2` cookbook
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ chef generate template learn_chef_apache2 index.html
Compiling Cookbooks...
Recipe: code_generator::template
  * directory[./learn_chef_apache2/templates/default] action create
    - create new directory ./learn_chef_apache2/templates/default
  * template[./learn_chef_apache2/templates/default/index.html.erb] action create
    - create new file ./learn_chef_apache2/templates/default/index.html.erb
    - update content in file ./learn_chef_apache2/templates/default/index.html.erb from none to e3b0c4
    (diff output suppressed by config)
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ # -- Review generated template file location in cookbook directory
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ tree
.
└── learn_chef_apache2
    ├── Berksfile
    ├── chefignore
    ├── metadata.rb
    ├── README.md
    ├── recipes
    │   └── default.rb
    ├── spec
    │   ├── spec_helper.rb
    │   └── unit
    │       └── recipes
    │           └── default_spec.rb
    ├── templates
    │   └── default
    │       └── index.html.erb
    └── test
        └── integration
            ├── default
            │   └── serverspec
            │       └── default_spec.rb
            └── helpers
                └── serverspec
                    └── spec_helper.rb

13 directories, 10 files
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ # -- Modify HTML template file
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ nano learn_chef_apache2/templates/default/index.html.erb
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ # -- Update the recipe to reference the HTML template
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ nano learn_chef_apache2/recipes/default.rb
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ # -- Run the cookbook
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ sudo chef-client --local-mode --runlist 'recipe[learn_chef_apache2]'
[2016-02-10T09:44:58+00:00] WARN: No config file found or specified on command line, using command line options.
Starting Chef Client, version 12.5.1
resolving cookbooks for run list: ["learn_chef_apache2"]
Synchronizing Cookbooks:
  - learn_chef_apache2 (0.1.0)
Compiling Cookbooks...
Converging 3 resources
Recipe: learn_chef_apache2::default
  * apt_package[apache2] action install (up to date)
  * service[apache2] action enable (up to date)
  * service[apache2] action start (up to date)
  * template[/var/www/html/index.html] action create
    - update content in file /var/www/html/index.html from 2914aa to ef4ffd
    (no diff)

Running handlers:
Running handlers complete
Chef Client finished, 1/4 resources updated in 02 seconds
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ # -- Run the cookbook
vagrant@vagrant:~/chef-repo/cookbooks$ # --------------------------------------------------------------------
vagrant@vagrant:~/chef-repo/cookbooks$ curl localhost
<html>
  <body>
    <h1>hello world</h1>
  </body>
</html>
vagrant@vagrant:~/chef-repo/cookbooks$